{
  "$schema": "http://json-schema/schema",
  "id": "http://elvaco.se/schema/elvaco-mvp-mq-schema-v01.json",
  "title": "Elvaco MVP MQ message schema version 0.1",
  "description": "This schema describes the format of the type of message that constitutes the protocol from a metering value delivery system and the MVP system.",
  "type": "object",
  "required": ["message_type","gateway_id","meter_id","organisation_id","medium","source_system_id","values"],
  "properties": {
    "message_type": {
      "description":"A description of the message type",
      "type": "string",
      "examples": ["Elvaco MVP MQ Message 1.0"],
      "enum": ["Elvaco MVP MQ Message 1.0"]
    },
    "gateway_id": {
      "description":"An identifier for the gateway that delivered the measurements contained in this message",
      "examples": "GW-CME3100-XXYYZZ",
      "type": "string"
    },
    "meter_id": {
      "description": "An identifier for the meter, should be unique within an organisation",
      "examples": "ABC-123-XYZ",
      "type": "string"
    },
    "organisation_id": {
      "description": "An identifier for the organisation that owns the meter for which this message was created",
      "examples": ["ORG-AN-IS-ATION", "SomeCompany", "ELV"],
      "type": "string"
    },
    "medium": {
      "description": "Describes the device type or medium that the meter for which this message was created handles (e.g temperature)",
      "examples": ["Room sensor", "Gas detector", "Water", "Pressure meter"],
      "type": "string"
    },
    "source_system_id": {
      "description": "An identifier for the system where this message originated",
      "examples": ["Some system"],
      "type": "string"
    },
    "values": {
      "description": "A collection of one or more measurements, likely of different units and/or quantities",
      "type": "array",
      "items": {
        "type": "object",
        "required": ["timestamp", "value", "unit", "quantity"],
        "properties": {
          "timestamp": {
            "description": "A timestamp in seconds since 1970-01-01 00:00:00 UTC when this measurement was _collected_",
            "examples": [1506069947],
            "type": "integer",
            "minimum": 0
          },
          "accumulated": {
            "description": "Whether this measurement represents an accumulated value (true) or not (false). The absence of this value is equivalent to specify it with a value of false",
            "type": "boolean",
            "default": false,
            "examples": [true, false]
          },
          "value": {
            "description": "A discrete measurement value",
            "examples": [0.659, "2017-09-22 10:45:14+02:00", 42, "SGVsbG8sIHRoZXJlIQo="],
            "anyOf": [ 
              {"type": "number"},
              {"type": "integer"},
              {"type": "string", "format": "date-time"},
              {"type": "string", "media":
                {
                  "binaryEncoding": "base64"
                }
              }
            ]
          },
          "unit": {
            "description": "The unit of this measurement (e.g m3, wH)",
            "examples": ["m3", "wH"],
            "type": "string"
          },
          "quantity": {
            "description": "A description, in english, of the type of measurement this value represents (e.g volume)",
            "examples": ["volume", "power"],
            "type": "string"
          }
        }
      }
    }
  }
}
